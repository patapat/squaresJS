<html>
  <head>
    <title>Squares</title>
    <link rel="stylesheet" type="text/css" href="lib/application.css">
  </head>

  <body>
    <canvas id="myCanvas"></canvas>
    <script type="text/javascript" src="lib/paper.js"></script>
    <script type="application/javascript" src="lib/jquery-2.1.3.min.js"></script>
    <script type="application/javascript" src="lib/util.js"></script>
    <script type="application/javascript" src="lib/movingSquare.js"></script>
    <script type="application/javascript" src="lib/squares.js"></script>
    <script type="application/javascript" src="lib/circles.js"></script>
    <script type="application/javascript" src="lib/powerUp.js"></script>
    <script type="application/javascript" src="lib/cursorSquare.js"></script>
    <script type="application/javascript" src="lib/game.js"></script>
    <script type="application/javascript" src="lib/gameView.js"></script>

    <script type="application/javascript">
      (function () {
        var canvasEl = document.getElementById("myCanvas");
        canvasEl.width = Squares.Game.DIM_X;
        canvasEl.height = Squares.Game.DIM_Y;
        var ctx = canvasEl.getContext("2d");
        ctx.fillStyle = Squares.Game.BG_COLOR;
        ctx.fillRect(0, 0, Squares.Game.DIM_X, Squares.Game.DIM_Y);
        var elemLeft = canvasEl.offsetLeft;
        var elemTop = canvasEl.offsetTop;
        var elements = [];
        // Squares.Game.SQUARE_OPACITY = 0.2;
        // var game = new Squares.Game(ctx);
        // var newGameView = new Squares.GameView(game, ctx);
        // newGameView.renderHomeScreen();
        // canvasEl.removeEventListener('mousemove', fakeGame.detectMouse);
        // var homeScreenTimer = setInterval( function( ) {
        //   fakeGame.homeScreenStep();
        //   fakeGame.draw(ctx, true);
        //   fakeGame.remove
        // renderPlayButton("black", elements[0])
        // }, 1000 / Squares.Game.FPS);


        function startGame() {
          canvasEl.style.cursor = "none";
          var game = new Squares.Game(ctx);
          new Squares.GameView(game, ctx).start();

          canvasEl.removeEventListener('click', buttonInteraction);
          canvasEl.removeEventListener('mousemove', buttonInteraction);
          // clearInterval(homeScreenTimer);
        }

        function renderPlayButton(color, element) {
          ctx.fillStyle = Squares.Game.BG_COLOR;
          ctx.fillRect(0, 0, Squares.Game.DIM_X, Squares.Game.DIM_Y);
          ctx.fillStyle = color;
          ctx.font = "40px Arial";
          ctx.fillText("Play", element.left + 5, element.top + 30);
        }

        function buttonInteraction(event) {
          var x = event.pageX - elemLeft;
          var y = event.pageY - elemTop;

          elements.forEach(function (element) {
            if (y > element.top && y < element.top + element.height
                && x > element.left && x < element.left + element.width) {
                  if (event.type === "click") {
                    startGame();
                  } else if (event.type === "mousemove") {
                    if (ctx.fillStyle === "#000000") {
                      renderPlayButton("red", element);
                    }
                  }
            } else {
              if (ctx.fillStyle === "#ff0000") {
                // renderPlayButton("grey", element);
                renderPlayButton("black", element);
              }
            }
          });
        }

        elements.push({
          color: "black",
          width: 100,
          height: 40,
          top: (Squares.Game.DIM_Y / 2) - 20,
          left: (Squares.Game.DIM_X / 2) - 50
        });

        elements.forEach(function (element) {
          renderPlayButton(element.color, element);
        });

        canvasEl.addEventListener('click', buttonInteraction);
        canvasEl.addEventListener('mousemove', buttonInteraction);
      })();
    </script>
  </body>
</html>
